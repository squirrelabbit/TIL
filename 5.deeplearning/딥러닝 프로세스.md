# 딥러닝 기초이론

## 딥러닝vs 머신러닝 vs 인공지능

- 머신러닝: 데이터를 이용해 앞 일을 예측하는 기법

-  인공지능의 큰 범주 안에 머신러닝이 속하고,  머신러닝 중 가장 좋은 효과를 내는 것이 딥러닝. 

​     -> 딥러닝을 배우려면 머신러닝의 기초 개념을 알아야 함

인공지능> 머신러닝 >딥러닝

## 데이터 

- 딥러닝은 데이터를 이용해 예측 또는 판별을 수행한다. 

-  지도학습(분류, 회귀) vs 비지도학습(GAN, 오토인코더) 

## 컴퓨터 

- CPU vs GPU 

- 대용량인 경우에는 GPU 작업환경을 갖추길 추천 프로그램 

- 딥러닝을 구동할 수 있게 프로그래밍

## 머신러닝 프로세스
머신러닝 : 데이터를 이용해 **미지의 일을 예측**하기 위해 만들어진 기법

학습(training) : 데이터가 입력되고 패턴이 분석되는 과정  

-  랜덤포레스트, 서포트 벡터 머신, 딥러닝 등 여러가지 머신러닝 기법들 존재

기존환자데이터입력 -> 머신러닝으로 학습 -> 새로운 환자 예측



# 딥러닝 프로세스

## 1. 퍼셉트론(Perceptron)이란

일단 **Perceptron**이라는 단어를 자세히 보면 퍼셉션과 뉴런, 이렇게 두 단어가 조합된 거라는 걸 알 수 있다.

- **Perception** : 무언가를 인지하는 능력
- **Neuron** : 감각 입력 정보를 의미있는 정보로 바꿔주는 뇌에 있는 신경 세포

결국 퍼셉트론은 생물학적 뉴런이 감각 정보를 받아서 문제를 해결하는 원리를 따라한 인공 뉴런이라고 볼 수 있다.

퍼셉트론을 하나만 보면 꽤 단순한 원리에 의해 결정을 내려준다.

![img](https://i0.wp.com/hleecaster.com/wp-content/uploads/2020/01/perceptron01.png?fit=1024%2C449)

**입력 값에 대해 가중치를 적용해 계산한 후, 확인해서 결과 전달하기.**

예를 들어 퍼셉트론 기반의 자율주행 자동차라고 하면, 왼쪽에 장애물이 있으면 오른쪽으로 핸들을 틀고 오른쪽에 장애물이 있으면 왼쪽으로 핸들을 트는 뭐 그런 셈. 장애물의 위치를 입력 받아서 어느 방향으로 핸들을 틀지 결정해주기만 하는 거다.

그런데 놀랍게도 **퍼셉트론은 자신이 내린 결과를 확인해서, 미래에는 더 나은 결정을 하도록 자기 자신을 수정한다!** 이게 딥러닝의 힘 아니겠는가.

물론 현실 세계는 이렇게 단순하지 않기 때문에 **수많은 퍼셉트론을 묶어놓은 일종의 다발, 신경망(neural network)**을 형성해서 문제를 해결해야 한다.

### 퍼셉트론의 구성요소

퍼셉트론은 세 가지 구성요소로 설명할 수 있다.

#### 1. Inputs

인풋. 입력값. 뭐 흔히 머신러닝에서 말하는 feature(속성 혹은 자질)이다. 예를 들어 ‘사람’이라고 치면 키, 몸무게, 나이 같은 거.

#### 2. Weights

가중치는 각 인풋에 대해 일정량의 중요도를 부여하는 개념이다. 예를 들어 어떤 인풋에 대해 가중치가 크다는 건 그 인풋이 아웃풋을 결정하는 데에 더 큰 역할을 한다는 뜻이다.

#### 3. Output

퍼셉트론은 인풋과 가중치를 사용해서 아웃풋을 생성한다. 물론 아웃풋의 유형은 문제의 특성에 따라 조금씩 다르게 나타날 수 있다. 예를 들어 비가 올지 예측하려면 아웃풋이 2진(binary)일 거다. 1 아니면 0, 비가 오거나 안 오거나 둘 중 하나니까. 그런데 만약 다음 날의 온도를 예측하는 거라면 아웃풋의 범위가 커진다.

#### 퍼셉트론이 아웃풋을 내는 원리

퍼셉트론은 인풋을 받으면 가중치에 따라 가중합(**weighted sum**)을 계산하고, 그 값이 특정 기준을 만족하면(**activation function**) 1, 아니면 0 으로 결과를 돌려주는 방식이다.(sigmoid)

뇌에 있는 신경 세포, 뉴런 들이 어떻게 작동하는지 이런 이미지로 흔히 표현하는데

![img](https://hleecaster.com/wp-content/uploads/2020/01/neuron.jpg)

여기 이렇게 불이 들어오는 것처럼, 퍼셉트론도 그런 거다.

### 퍼셉트론의 학습 방법

만약 인풋과 아웃풋을 모두 알고 있는 데이터가 있으면 이 퍼셉트론이 제대로 아웃풋을 냈는지 아닌지 확인할 수가 있다. 그래서 퍼셉트론은 결과를 제대로 못 맞출 때마다 학습 오류(**training error**)를 만들어내는 셈이다.

퍼셉트론의 성능을 개선하기 위해서는 이 퍼셉트론을 정의하는 파라미터, 즉 가중치를 변경해야 할 거다. 그리고 정답을 최대한 많이 맞출 수 있도록 **최적의 가중치 조합을 찾는 게 학습의 목표**가 된다.

출처: [퍼셉트론(Perceptron)과 신경망(Neural Networks) 쉽게 이해하기 - 아무튼 워라밸 (hleecaster.com)](https://hleecaster.com/ml-perceptron-concept/)



## 2. 딥러닝 구조

### 데이터셋

![image-20220222093020382](./딥러닝 프로세스.assets/image-20220222093020382.png)


: 행은전체가져오기

열은 0:17/ 17만 가져오기

### 딥러닝 코드 구조
![image-20220222095453189](딥러닝.assets/image-20220222095453189.png)


Dense layer (다층구도): 덴스함수

덴스 = 레이어

- 하나의 레이어에 node 30개
- 인풋레이어: input_dim
- 히든레이어: activation = 'relu'
- 아웃풋레이어: node =1activation = 'sigmoid' (0또는 1출력)

![image-20220222101356457](딥러닝.assets/image-20220222101356457.png)

## 3. 딥러닝 실행


에폭:반복(for문)학습 batchsize:470개중에 10개씩 쪼개서 들어가짐

한번 에폭당 47개 배치가 돔

### `최적화과정`

loss는 예측이 실패할 확률, accuracy는 예측이 성공할 확률임

예측 성공률은 데이터를 분석해 데이터를 확장하거나, 딥러닝 구조를 적절하게 바꾸는 등의 노력으로 더 향상 가능 

 그뿐만 아니라 학습에 사용되지 않은 데이터를 따로 모아 테스트를 해 보면서 이 예측 성공률이 정말로 가능한지를 확인 하는 과정까지 거치게 됨 

- 이러한 ‘**최적화 과정**’을 진행하려면 딥러닝의 구동 원리를 이해해야 함***가장중요

## 4. 딥러닝 프로세스

> 입력값이 네트워크 층을 거치면 예측값이 나오고, 이를 실제값과 비교해서 Loss score를 계산한 후에 Optimizer를 통해 Weight를 업데이트 한다

![image-20220222112650154](딥러닝 프로세스.assets/image-20220222112650154.png)



![image-20220222101356457](딥러닝 프로세스.assets/image-20220222101356457.png)



model.add( ) 함수안에는 Dense( ) 함수가 포함되어 있음 

- dense는 ‘조밀하게 모여있는 집합’이란 뜻으로, 

  각 층이 제각각 어떤 특성을 가질지 옵션을 설정하는 역할 

- 딥러닝의 구조와 층별 옵션을 정하고 나면 compile( ) 함수를 이용해 이를 실행 

  - activation : 다음 층으로 어떻게 값을 넘길지 결정하는 부분 

	​                           가장 많이 사용되는 함수 : relu() 함수, sigmoid() 함수

  ![image-20220222113533513](딥러닝 프로세스.assets/image-20220222113533513.png)

  - loss : 한 번 신경망이 실행될 때마다 오차 값을 추적하는 함수 

  - optimizer : 오차를 어떻게 줄여 나갈지 정하는 함수

     loss function: binary_crossentropy: 이진분류

     optimizer = 'adam' :오차 줄이는법 거의 **경사강법**
  
     metrics = 평가지표 "accuracy"

## 5. 오차함수

![image-20220222114002338](딥러닝 프로세스.assets/image-20220222114002338.png)

위는 회귀/ 아래는 분류
